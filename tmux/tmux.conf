##################
#  Basic Config  #
##################

# 256-color
# 这个不能打开，否则和自动补全有冲突
# set -g default-terminal "tmux-256color"

set -g prefix C-b               # 设置 leader
set -g mouse              on    # 开启鼠标
setw -g allow-rename      off   # 禁止活动进程修改窗口名
setw -g automatic-rename  off   # 禁止自动命名新窗口
set -g base-index         1     # 窗口编号从 1 开始计数
set -g display-panes-time 10000 # PREFIX-Q 显示编号的驻留时长，单位 ms
set -g pane-base-index    1     # 窗格编号从 1 开始计数
set -g renumber-windows   on    # 关掉某个窗口后，编号重排


##################
#  Key Mappings  #
##################
setw -g mode-keys vi            # 启动 vi 模式，leader + [ 进入

# For more similiar to vim
bind -T copy-mode-vi v send-keys -X begin-selection                     # 绑定v键为开始选择文本
bind -T copy-mode-vi y send-keys -X copy-selection-and-cancel           # 绑定y键为复制选中文本


bind r source-file ~/.tmux.conf \; display-message "Config reloaded.."  # 绑定快捷键为r
bind -r e lastp                                                         # 选择最后一个面板

# Split window
bind c new-window -c "#{pane_current_path}"                             # 保持当前路径
bind-key | split-window -h -c "#{pane_current_path}"
bind-key - split-window -c "#{pane_current_path}"

# h/j/k/l Move pane
bind -r k select-pane -U                                                # 绑定k为↑
bind -r j select-pane -D                                                # 绑定j为↓
bind -r h select-pane -L                                                # 绑定h为←
bind -r l select-pane -R                                                # 绑定l为→

bind -r ^k resizep -U 1
bind -r ^j resizep -D 1
bind -r ^h resizep -L 1
bind -r ^l resizep -R 1


#######################
#  Custom Status Bar  #
#######################
set -g status-interval 1                                                # 状态栏刷新时间
set -g status-justify left                                              # 状态栏列表左对齐
setw -g monitor-activity on                                             # 非当前窗口有内容更新时在状态栏通知

set -g status-bg black                                                  # 设置状态栏背景黑色
set -g status-fg yellow                                                 # 设置状态栏前景黄色
set -g status-style "bg=black, fg=yellow"                               # 状态栏前景背景色

set -g status-left "#[bg=#FF661D] ❐ #S "                                # 状态栏左侧内容
set -g status-left-length 300                                           # 状态栏左边长度300
set -g status-right-length 500                                          # 状态栏左边长度500

set -wg window-status-format " #I #W "                                  # 状态栏窗口名称格式
set -wg window-status-current-format " #I:#W#F "                        # 状态栏当前窗口名称格式(#I：序号，#w：窗口名称，#F：间隔符)
set -wg window-status-separator ""                                      # 状态栏窗口名称之间的间隔
set -wg window-status-current-style "bg=red"                            # 状态栏当前窗口名称的样式
set -wg window-status-last-style "fg=red"                               # 状态栏最后一个窗口名称的样式

set -g message-style "bg=#202529, fg=#91A8BA"                           # 指定消息通知的前景、后景色
set -g pane-border-format "#{pane_index} #T"

###################
#  Plugin Config  #
###################
setenv -g TMUX_PLUGIN_MANAGER_PATH '~/.tmux/plugins'

set -g @plugin 'tmux-plugins/tpm'                                       # prefix + I install prefix + U update
set -g @plugin 'tmux-plugins/tmux-sensible'                             # group of settings
set -g @plugin 'tmux-plugins/tmux-prefix-highlight'                     # highlight my prefix alert
set -g @plugin 'tmux-plugins/tmux-resurrect'                            # prefix + <c-s> to save prefix + <c-r> to reload
set -g @plugin 'tmux-plugins/tmux-continuum'                            # back up in 15 min
set -g @plugin 'tmux-plugins/tmux-yank'                                 # prefix + y to copy
set -g @plugin 'tmux-plugins/tmux-copycat'                              # prefix + / to search prefix + ] to copy
set -g @plugin 'seebi/tmux-colors-solarized'

# tmux-continuum
set -g @continuum-boot 'on'                  # 自动启动 tmux
set -g @continuum-restore 'on'               # tmux 启动时自动恢复
set -g @continuum-save-interval '15'         # back up per 15min
set -g @continuum-boot-options 'iterm,fullscreen'

# tmux-resurrect
set -g @resurrect-dir '~/.tmux/resurrect'
set -g @resurrect-capture-pane-contents 'on' # 恢复面板内容
set -g @resurrect-strategy-vim 'session'     # 恢复vim会话状态<Paste>

# tmux-prefix-highlight
set -g status-right '#{prefix_highlight} #H | %a %Y-%m-%d %H:%M'
set -g @prefix_highlight_show_copy_mode 'on'
set -g @prefix_highlight_copy_mode_attr 'fg=white,bg=blue'

run '~/.tmux/plugins/tpm/tpm'
